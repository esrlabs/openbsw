<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content="EclipseOpenBSWDocumentation" name="dox_trace_storage" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tracing &mdash; Eclipse OpenBSW Documentation  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../../_static/rtd_theme_overrides.css?v=6fd0d55b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../_static/colors.css?v=3cafd8aa" />
      <link rel="stylesheet" type="text/css" href="../../../_static/colored_table.css?v=34b816d5" />
      <link rel="stylesheet" type="text/css" href="../../../_static/header.css?v=e632285e" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dox_util_colors.css?v=dd14b177" />
      <link rel="stylesheet" type="text/css" href="../../../_static/dox_trace.css?v=60d3f72c" />

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../../../_static/copybutton.js?v=f281be69"></script>
        <script src="../../../_static/dox_trace.js?v=40719b51"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Hardware Testing Guide" href="../SysTest/HW_Testing_Guide.html" />
    <link rel="prev" title="Using hardware I/O" href="../hwio/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Eclipse OpenBSW Documentation
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Learning</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../overview.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../setup/index.html">Set up your environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../layout/index.html">Understanding the directory structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../console/index.html">Using the console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../unit_tests/index.html">Building and Running Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lifecycle/index.html">Managing the lifecycle of components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging to the console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/index.html">Adding commands to the console</a></li>
<li class="toctree-l2"><a class="reference internal" href="../can/index.html">Working with CAN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ethernet/index.html">Working with Ethernet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../uds/index.html">Using UDS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwio/index.html">Using hardware I/O</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tracing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building">Building</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analyzing-the-data">Analyzing the Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../SysTest/HW_Testing_Guide.html">Hardware Testing Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guidelines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../guidelines/conventions/index.html">Coding Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guidelines/practices.html">Coding Practices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guidelines/3rdparty.html">Third Party Libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guidelines/codeFormatting/index.html">Code Formatting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/posix/index.html">POSIX</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/s32k148evb/index.html">S32K148 Evaluation Board</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../features/storage.html">Persistent Storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../features/functional_safety.html">Functional Safety</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Software Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules/common.html">Common</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/posix.html">Posix</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/s32k1xx.html">S32K1xx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/executables.html">Executables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../modules/mocks.html">Mocks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/UdsTool/doc/index.html">UdsTool</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tools/puncover_tool/doc/index.html">Puncover</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Eclipse OpenBSW Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content style-external-links">
          <div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../overview.html">Getting Started</a> &raquo;</li>
        
        <li>Tracing</li>
    

    

      <li class="wy-breadcrumbs-aside">

        <!-- DOCUMENT STATUS -->

        

        <!-- DATA CLASSIFICATION -->

        

      </li>

    
  </ul>

  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tracing">
<span id="learning-tracing"></span><h1>Tracing<a class="headerlink" href="#tracing" title="Link to this heading"></a></h1>
<p>Previous: <a class="reference internal" href="../hwio/index.html#learning-hwio"><span class="std std-ref">Using hardware I/O</span></a></p>
<p>The tracing feature collects scheduling events like task switches and interrupt entry and exit.
This data can be used by tracing tools (e.g. <a class="reference external" href="https://babeltrace.org/">babeltrace2</a>)
running on a host to visualize the kernel’s inner workings and the behavior of its subsystems
(e.g. when a task is switched in or out).</p>
<p>The internal trace format is very efficient and usually uses a single 32 bit word per traced event.
After the trace is done, the data is downloaded via a debugger and a post processing script is
used to convert the traced data to other trace formats.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<p>Before using the tracer it should be initialized. Initialization also clears the tracing buffer
and ensures that existing data in the buffer is not confused with actual tracing data.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">runtime</span><span class="o">::</span><span class="n">Tracer</span><span class="o">::</span><span class="n">init</span><span class="p">();</span>
</pre></div>
</div>
<p>When tracing is started, events are recorded into the tracing buffer.
It is possible to stop tracing and restart it later. Note however, that the time span
recorded between events before and after a longer pause might be wrong due to overflow
of the underlying clock.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">runtime</span><span class="o">::</span><span class="n">Tracer</span><span class="o">::</span><span class="n">start</span><span class="p">();</span>
<span class="n">runtime</span><span class="o">::</span><span class="n">Tracer</span><span class="o">::</span><span class="n">stop</span><span class="p">();</span>
</pre></div>
</div>
<p>Once the trace buffer is full, the tracing will stop automatically.
You can use the <cite>init()</cite> method to start over with an empty trace buffer.</p>
<p>In order to trace their own custom events, users may use the method <cite>traceUser(uint8_t usrIdx)</cite>.
The <cite>usrIdx</cite> argument can be used to distinguish different user events.</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">runtime</span><span class="o">::</span><span class="n">Tracer</span><span class="o">::</span><span class="n">traceUser</span><span class="p">(</span><span class="kt">uint8_t</span><span class="w"> </span><span class="n">usrIdx</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="building">
<h2>Building<a class="headerlink" href="#building" title="Link to this heading"></a></h2>
<p>Use build flag <cite>-DBUILD_TRACING=ON</cite> to turn tracing on and <cite>-DTRACING_BUFFER_SIZE</cite> to configure
the tracing buffer size. For example, to build for S32K148EVB:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cmake<span class="w"> </span>--preset<span class="w"> </span>s32k148-gcc<span class="w"> </span>-DBUILD_TRACING<span class="o">=</span>ON<span class="w"> </span>-DTRACING_BUFFER_SIZE<span class="o">=</span><span class="m">65536</span>
cmake<span class="w"> </span>--build<span class="w"> </span>--preset<span class="w"> </span>s32k148-gcc
</pre></div>
</div>
<p>The size of tracing buffer in RAM is configurable (TRACING_BUFFER_SIZE).
If it is not provided in the cmake command, then the default value of 4096 bytes is configured.</p>
</section>
<section id="analyzing-the-data">
<h2>Analyzing the Data<a class="headerlink" href="#analyzing-the-data" title="Link to this heading"></a></h2>
<p>Once the application is run, one can collect binary traces using gdb:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>info<span class="w"> </span>address<span class="w"> </span>runtime::Tracer::_ramTraces
Symbol<span class="w"> </span><span class="s2">&quot;runtime::Tracer::_ramTraces&quot;</span><span class="w"> </span>is<span class="w"> </span>static<span class="w"> </span>storage<span class="w"> </span>at<span class="w"> </span>address<span class="w"> </span>0x1ffee6bc.
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>dump<span class="w"> </span>binary<span class="w"> </span>memory<span class="w"> </span>trace_file<span class="w"> </span>0x1ffee6bc<span class="w"> </span>0x1ffee6bc+65536
</pre></div>
</div>
<p>This is an example of using trace_convert.py script to convert a binary trace to human-readable format.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>trace_file<span class="w"> </span>.
cp<span class="w"> </span>tools/tracing/trace_convert.py<span class="w"> </span>.
python3<span class="w"> </span>./trace_convert.py<span class="w"> </span>trace_file<span class="w"> </span>&gt;<span class="w"> </span>output
</pre></div>
</div>
<p>This is an example of using the babeltrace2 tool and source plugin bt_plugin_openbsw.py to convert
a binary trace to human-readable format. The plugin is used to read trace data from <code class="docutils literal notranslate"><span class="pre">trace_file</span></code>
in described format and feed it into the babeltrace2 framework for conversion.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cp<span class="w"> </span>trace_file<span class="w"> </span>.
cp<span class="w"> </span>tools/tracing/trace_convert.py<span class="w"> </span>.
cp<span class="w"> </span>tools/tracing/bt_plugin_openbsw.py<span class="w"> </span>.
babeltrace2<span class="w"> </span>--plugin-path<span class="w"> </span>.<span class="w"> </span>-c<span class="w"> </span>source.openbsw.OpenBSWSource<span class="w"> </span>--params<span class="w"> </span><span class="s1">&#39;inputs=[&quot;trace_file&quot;]&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>output
</pre></div>
</div>
<p>This is an example output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[01:00:00.009286800] (+?.?????????) thread_switched_in: { id = 8 }
[01:00:00.009307300] (+0.000020500) thread_switched_out: { id = 8 }
[01:00:00.009312387] (+0.000005087) thread_switched_in: { id = 7 }
[01:00:00.009321662] (+0.000009275) thread_switched_out: { id = 7 }
[01:00:00.009325687] (+0.000004025) thread_switched_in: { id = 6 }
[01:00:00.009459762] (+0.000134075) thread_switched_out: { id = 6 }
[01:00:00.009465125] (+0.000005363) thread_switched_in: { id = 5 }
[01:00:00.009473562] (+0.000008437) thread_switched_out: { id = 5 }
[01:00:00.009478112] (+0.000004550) thread_switched_in: { id = 4 }
[01:00:00.009486075] (+0.000007963) thread_switched_out: { id = 4 }
[01:00:00.009490187] (+0.000004112) thread_switched_in: { id = 3 }
[01:00:00.009500287] (+0.000010100) thread_switched_out: { id = 3 }
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025 Accenture.</p>
  </div>

  <div role="footer_string">
    <p>Documentation from 2025-10-29 13:27:50, official build.</p>

    
      <a href="../../../_sources/doc/learning/tracing/index.rst.txt" rel="nofollow"> View page source</a>
    

  </div>

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>